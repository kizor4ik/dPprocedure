(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     26537,        733]
NotebookOptionsPosition[     25751,        715]
NotebookOutlinePosition[     26093,        730]
CellTagsIndexPosition[     26050,        727]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "\:0431\:043b\:043e\:043a", " ", "\:0432\:0432\:043e\:0434\:0430"}], 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "\:043a\:0432\:0430\:043d\:0442\:043e\:0432\:044b\:0435", " ", 
    "\:0447\:0438\:0441\:043b\:0430"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       SubscriptBox["k", "0"], "=", "5"}], ",", 
      RowBox[{"kp", " ", "=", " ", "3"}]}], "}"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
   "(*", "\:0445\:043e\:043b\:0435\:0441\:0442\:0435\:0440\:0438\:043a", 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\[Epsilon]1", " ", "=", " ", "1"}], ",", 
      RowBox[{"\[Epsilon]2", " ", "=", " ", "1.2"}], ",", 
      RowBox[{"q", " ", "=", "10"}]}], "}"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
   "(*", "\:0442\:0440\:0430\:0435\:043a\:0442\:043e\:0440\:0438\:044f", 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"\[Beta]3", "=", "1"}], "}"}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{
      "\:0433\:0434\:0435", " ", "\:0438\:0437", " ", 
       "\:0444\:0430\:0439\:043b\:0430", " ", "k0"}], ":=", " ", 
      RowBox[{
       RowBox[{"\\", "overline"}], 
       SubscriptBox[
        RowBox[{"{", "k", "}"}], "0"]}]}], ",", 
     RowBox[{"kp", ":=", " ", 
      RowBox[{"k_", "\\", "perp"}]}], ",", 
     RowBox[{"k3", ":=", " ", 
      RowBox[{"Sqrt", "[", 
       RowBox[{
        SuperscriptBox["k0", "2"], "-", 
        SuperscriptBox["kp", "2"]}], "]"}]}], ",", 
     RowBox[{"\[Theta]", ":=", 
      RowBox[{
       RowBox[{"\\", "overline"}], 
       RowBox[{"{", "\[Theta]", "}"}]}]}], ",", " ", 
     RowBox[{"\[Epsilon]1", ":=", " ", 
      RowBox[{"\[Epsilon]_", "\\", "parallel"}]}], ",", " ", 
     RowBox[{"\[Epsilon]2", ":=", 
      RowBox[{"\[Epsilon]_", "\\", "perp"}]}]}], " ", "*)"}]}]}]], "Input",
 CellChangeTimes->{{3.804202611774514*^9, 3.804202655557866*^9}, {
   3.8042027009569597`*^9, 3.8042027678395967`*^9}, {3.8042028471489153`*^9, 
   3.804202856279769*^9}, 3.804202944369604*^9, {3.804202997287122*^9, 
   3.8042030196242013`*^9}, {3.8042031761277027`*^9, 
   3.8042032367082925`*^9}, {3.80420335754538*^9, 3.804203375021575*^9}, {
   3.8042035882561445`*^9, 3.804203625653925*^9}, 3.8042045579463644`*^9, {
   3.8042081506144114`*^9, 3.8042082307243214`*^9}},
 CellLabel->"In[92]:=",ExpressionUUID->"b033db3c-807e-4aff-9071-e56f7d649752"],

Cell[BoxData[
 RowBox[{
  RowBox[{
  "(*", "\:0438\:043d\:0438\:0446\:0430\:043b\:0438\:0437\:0430\:0446\:0438\
\:044f", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"long", " ", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"k0", "\[Rule]", " ", 
        RowBox[{
         SqrtBox["\[Epsilon]2"], 
         SubscriptBox["k", "0"]}]}], ",", 
       RowBox[{"k3", " ", "\[Rule]", "  ", 
        SqrtBox[
         RowBox[{
          RowBox[{"\[Epsilon]2", " ", 
           SuperscriptBox[
            SubscriptBox["k", "0"], "2"]}], "-", 
          SuperscriptBox["kp", "2"]}]]}], ",", 
       RowBox[{"\[Theta]", " ", "\[Rule]", "  ", 
        RowBox[{
         RowBox[{"q", " ", "z"}], " ", "-", " ", "\[Phi]"}]}], ",", " ", 
       RowBox[{"\[Delta]\[Epsilon]", " ", "\[Rule]", 
        FractionBox[
         RowBox[{" ", 
          RowBox[{"\[Epsilon]1", " ", "-", " ", "\[Epsilon]2"}]}], 
         "\[Epsilon]2"]}], ",", " ", 
       RowBox[{"np", " ", "\[Rule]", " ", 
        FractionBox["kp", 
         SubscriptBox["k", "0"]]}], ",", 
       RowBox[{"n3", "\[Rule]", " ", 
        FractionBox[
         SqrtBox[
          RowBox[{
           RowBox[{"\[Epsilon]2", " ", 
            SuperscriptBox[
             SubscriptBox["k", "0"], "2"]}], "-", 
           SuperscriptBox["kp", "2"]}]], 
         SubscriptBox["k", "0"]]}], ",", 
       RowBox[{"n32", " ", "\[Rule]", " ", 
        FractionBox[
         RowBox[{
          FractionBox["2", "\[Pi]"], 
          RowBox[{"EllipticE", "[", 
           FractionBox[
            RowBox[{
             RowBox[{"-", 
              SuperscriptBox["kp", "2"]}], "\[Delta]\[Epsilon]"}], 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "+", "\[Delta]\[Epsilon]"}], ")"}], 
             SuperscriptBox["k3", "2"]}]], "]"}], 
          SqrtBox[
           RowBox[{"(", 
            RowBox[{"1", "+", "\[Delta]\[Epsilon]"}], ")"}]], "k3"}], 
         SubscriptBox["k", "0"]]}], ",", 
       RowBox[{
        SubscriptBox["p", "3"], "\[Rule]", " ", 
        RowBox[{
         FractionBox["2", "\[Pi]"], 
         RowBox[{"EllipticE", "[", 
          FractionBox[
           RowBox[{
            RowBox[{"-", 
             SuperscriptBox["kp", "2"]}], "\[Delta]\[Epsilon]"}], 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"1", "+", "\[Delta]\[Epsilon]"}], ")"}], 
            SuperscriptBox["k3", "2"]}]], "]"}], 
         SqrtBox[
          RowBox[{"(", 
           RowBox[{"1", "+", "\[Delta]\[Epsilon]"}], ")"}]], "k3"}]}]}], 
      "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"S", "[", "\[Theta]_", "]"}], ":=", " ", 
     RowBox[{
      SuperscriptBox["q", 
       RowBox[{"-", "1"}]], 
      SqrtBox[
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "+", "\[Delta]\[Epsilon]"}], ")"}], 
        SuperscriptBox["k3", "2"]}]], 
      RowBox[{"EllipticE", "[", 
       RowBox[{"\[Theta]", ",", 
        FractionBox[
         RowBox[{
          RowBox[{"-", 
           SuperscriptBox["kp", "2"]}], "\[Delta]\[Epsilon]"}], 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "+", "\[Delta]\[Epsilon]"}], ")"}], 
          SuperscriptBox["k3", "2"]}]]}], "]"}]}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "\:043c\:043e\:0434\:043e\:0432\:044b\:0435", " ", 
     "\:0444\:0443\:043d\:043a\:0446\:0438\:0438", " ", "\:0434\:043b\:044f", 
     " ", "\:043a\:0432\:0430\:0437\:0438\:043a\:043b\:0430\:0441\:0441\:0438\
\:043a\:0438", " ", "vcb_", " ", "\:0441", " ", 
     "\:0443\:0447\:0435\:0442\:043e\:043c", " ", 
     "\:043f\:0440\:0438\:043c\:0435\:043d\:0438\:043c\:043e\:0441\:0442\:0438\
", " ", "\:0442\:0435\:043e\:0440\:0438\:0438", " ", 
     RowBox[{"(", 
      RowBox[{
      "\:0432\:0435\:0434\:0443\:0449\:0438\:0439", " ", 
       "\:043f\:043e\:0440\:044f\:0434\:043e\:043a", " ", "\:043f\:043e", " ", 
       RowBox[{"n_", "\\", "perp"}]}], ")"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "\:043e\:0431\:044b\:043a\:043d\:043e\:0432\:0435\:043d\:043d\:0430\:044f\
", " ", "\:0432\:043e\:043b\:043d\:0430"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"a1p", " ", "=", " ", 
     RowBox[{
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"2", "k0"}], ")"}], 
        RowBox[{
         RowBox[{"-", "1"}], "/", "2"}]], "\[ImaginaryI]", " ", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"\[ImaginaryI]", " ", "\[Theta]"}]], 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"\[ImaginaryI]", " ", "k3", " ", "z"}]]}], " ", "/.", " ", 
      "long"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"a1m", " ", "=", " ", 
     RowBox[{
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"2", "k0"}], ")"}], 
        RowBox[{
         RowBox[{"-", "1"}], "/", "2"}]], 
       RowBox[{"(", 
        RowBox[{"-", "\[ImaginaryI]"}], ")"}], " ", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{
         RowBox[{"-", "\[ImaginaryI]"}], " ", "\[Theta]"}]], 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"\[ImaginaryI]", " ", "k3", " ", "z"}]]}], " ", "/.", " ", 
      "long"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"a13", " ", "=", " ", 
     RowBox[{
      FractionBox[
       RowBox[{"kp", " ", 
        RowBox[{"Sin", "[", "\[Theta]", "]"}], 
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{"\[ImaginaryI]", " ", "k3", " ", "z"}]]}], 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"2", 
          SuperscriptBox["k0", "3"]}], ")"}], 
        RowBox[{"1", "/", "2"}]]], " ", "/.", " ", "long"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "\:043e\:0442\:0440\:0430\:0436\:0435\:043d\:043d\:0430\:044f", " ", 
     "\:043e\:0431\:044b\:0447\:043d\:043e\:0432\:0435\:043d\:043d\:0430\:044f\
", " ", "\:0432\:043e\:043b\:043d\:0430"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"b1p", " ", "=", " ", 
     RowBox[{
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"2", "k0"}], ")"}], 
        RowBox[{
         RowBox[{"-", "1"}], "/", "2"}]], "\[ImaginaryI]", " ", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"\[ImaginaryI]", " ", "\[Theta]"}]], 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{
         RowBox[{"-", "\[ImaginaryI]"}], " ", "k3", " ", "z"}]]}], " ", "/.", 
      " ", "long"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"b1m", " ", "=", " ", 
     RowBox[{
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"2", "k0"}], ")"}], 
        RowBox[{
         RowBox[{"-", "1"}], "/", "2"}]], 
       RowBox[{"(", 
        RowBox[{"-", "\[ImaginaryI]"}], ")"}], " ", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{
         RowBox[{"-", "\[ImaginaryI]"}], " ", "\[Theta]"}]], 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{
         RowBox[{"-", "\[ImaginaryI]"}], " ", "k3", " ", "z"}]]}], " ", "/.", 
      " ", "long"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"b13", " ", "=", " ", 
     RowBox[{
      FractionBox[
       RowBox[{
        RowBox[{"-", "kp"}], " ", 
        RowBox[{"Sin", "[", "\[Theta]", "]"}], 
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{
          RowBox[{"-", "\[ImaginaryI]"}], " ", "k3", " ", "z"}]]}], 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"2", 
          SuperscriptBox["k0", "3"]}], ")"}], 
        RowBox[{"1", "/", "2"}]]], " ", "/.", " ", "long"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "\:043d\:0435\:043e\:0431\:044b\:043a\:043d\:043e\:0432\:0435\:043d\:043d\
\:0430\:044f", " ", "\:0432\:043e\:043b\:043d\:0430"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"a2p", " ", "=", " ", 
     RowBox[{
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"2", 
          SubscriptBox["k", "0"], 
          SuperscriptBox["\[Epsilon]1", 
           RowBox[{"1", "/", "2"}]]}], ")"}], 
        RowBox[{
         RowBox[{"-", "1"}], "/", "2"}]], 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"\[ImaginaryI]", " ", "\[Theta]"}]], 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"\[ImaginaryI]", " ", 
         RowBox[{"S", "[", "\[Theta]", "]"}]}]]}], "/.", "long"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"a2m", " ", "=", " ", 
     RowBox[{
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"2", 
          SubscriptBox["k", "0"], 
          SuperscriptBox["\[Epsilon]1", 
           RowBox[{"1", "/", "2"}]]}], ")"}], 
        RowBox[{
         RowBox[{"-", "1"}], "/", "2"}]], 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{
         RowBox[{"-", "\[ImaginaryI]"}], " ", "\[Theta]"}]], 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"\[ImaginaryI]", " ", 
         RowBox[{"S", "[", "\[Theta]", "]"}]}]]}], "/.", "long"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"a23", " ", "=", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "kp"}], " ", 
       RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
       SuperscriptBox[
        RowBox[{"(", 
         FractionBox[
          RowBox[{
           SubscriptBox["k", "0"], 
           SuperscriptBox["\[Epsilon]1", 
            RowBox[{"1", "/", "2"}]]}], 
          RowBox[{"2", " ", 
           SuperscriptBox["k0", "4"]}]], ")"}], 
        RowBox[{"1", "/", "2"}]], 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"\[ImaginaryI]", " ", 
         RowBox[{"S", "[", "\[Theta]", "]"}]}]]}], " ", "/.", "long"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "\:043d\:0435\:043e\:0431\:044b\:043a\:043d\:043e\:0432\:0435\:043d\:043d\
\:0430\:044f", " ", 
     "\:043e\:0442\:0440\:0430\:0436\:0435\:043d\:043d\:0430\:044f", " ", 
     "\:0432\:043e\:043b\:043d\:0430"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"b2p", " ", "=", " ", 
     RowBox[{
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"2", 
          SubscriptBox["k", "0"], 
          SuperscriptBox["\[Epsilon]1", 
           RowBox[{"1", "/", "2"}]]}], ")"}], 
        RowBox[{
         RowBox[{"-", "1"}], "/", "2"}]], 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"\[ImaginaryI]", " ", "\[Theta]"}]], 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{
         RowBox[{"-", "\[ImaginaryI]"}], " ", 
         RowBox[{"S", "[", "\[Theta]", "]"}]}]]}], "/.", "long"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"b2m", " ", "=", " ", 
     RowBox[{
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"2", 
          SubscriptBox["k", "0"], 
          SuperscriptBox["\[Epsilon]1", 
           RowBox[{"1", "/", "2"}]]}], ")"}], 
        RowBox[{
         RowBox[{"-", "1"}], "/", "2"}]], 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{
         RowBox[{"-", "\[ImaginaryI]"}], " ", "\[Theta]"}]], 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{
         RowBox[{"-", "\[ImaginaryI]"}], " ", 
         RowBox[{"S", "[", "\[Theta]", "]"}]}]]}], "/.", "long"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"b23", " ", "=", " ", 
     RowBox[{
      RowBox[{"kp", " ", 
       RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
       SuperscriptBox[
        RowBox[{"(", 
         FractionBox[
          RowBox[{
           SubscriptBox["k", "0"], 
           SuperscriptBox["\[Epsilon]1", 
            RowBox[{"1", "/", "2"}]]}], 
          RowBox[{"2", " ", 
           SuperscriptBox["k0", "4"]}]], ")"}], 
        RowBox[{"1", "/", "2"}]], 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{
         RowBox[{"-", "\[ImaginaryI]"}], " ", 
         RowBox[{"S", "[", "\[Theta]", "]"}]}]]}], " ", "/.", "long"}]}], 
    ";"}]}]}]], "Input",
 CellChangeTimes->{{3.8039956383647327`*^9, 3.803995666639499*^9}, {
   3.804128862051386*^9, 3.8041291644767675`*^9}, {3.8041291980294943`*^9, 
   3.8041293160831833`*^9}, {3.8042026060875764`*^9, 3.804202607972434*^9}, {
   3.8042027822329645`*^9, 3.8042027865555644`*^9}, {3.8042028613469715`*^9, 
   3.8042028619760237`*^9}, {3.8042029800298753`*^9, 3.8042029907846794`*^9}, 
   3.8042031743627806`*^9, {3.804203314021476*^9, 3.804203344564351*^9}, {
   3.8042034046178713`*^9, 3.8042035770067134`*^9}, {3.8042036333290386`*^9, 
   3.804203720875741*^9}, {3.804204230512771*^9, 3.80420438400917*^9}, {
   3.8042045363637214`*^9, 3.804204732762456*^9}, {3.804205007943741*^9, 
   3.804205025233876*^9}, {3.8042050685835633`*^9, 3.8042050747502546`*^9}, {
   3.8042051073429313`*^9, 3.8042051835716944`*^9}, {3.804205543653661*^9, 
   3.804205553363386*^9}, {3.8042070123781395`*^9, 3.8042070206884212`*^9}, {
   3.804208120640811*^9, 3.804208138713949*^9}, {3.8042084141244698`*^9, 
   3.804208431631127*^9}, {3.8042085447141914`*^9, 3.8042086149868717`*^9}, {
   3.8042089888256745`*^9, 
   3.804208989812357*^9}},ExpressionUUID->"eeab84a9-99c5-469a-8133-\
2ca4c9c06858"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.804203027633938*^9, 
  3.804203047873371*^9}},ExpressionUUID->"b8ebbb03-2a5d-4f9d-91ab-\
fabf70387318"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "\:0442\:0435\:043e\:0440\:0435\:0442\:0438\:0447\:0435\:0441\:043a\:0430\
\:044f", " ", "\:0444\:043e\:0440\:043c\:0443\:043b\:0430", " ", 
    "\:0438\:0437\:043b\:0443\:0447\:0435\:043d\:0438\:044f"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"dPvcb", "[", 
     RowBox[{"s_", ",", "m_", ",", "kth_", ",", "kzr_"}], "]"}], ":=", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"Abs", "[", 
       RowBox[{"Z", " ", "e", " ", "c", " ", "\[Beta]3"}], "]"}], "2"], 
     RowBox[{
      UnderoverscriptBox["\[Sum]", 
       RowBox[{"n", "=", 
        RowBox[{"-", "\[Infinity]"}]}], 
       RowBox[{"+", "\[Infinity]"}]], 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox[
           RowBox[{"\[Delta]N", "[", 
            RowBox[{"x", "[", "n", "]"}], "]"}], "2"], " ", 
          RowBox[{"KroneckerDelta", "[", 
           RowBox[{"m", ",", " ", 
            RowBox[{
             RowBox[{"2", "n"}], "+", "1", "+", "s"}]}], "]"}], 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"1", "+", 
             SuperscriptBox["\[Epsilon]2", 
              RowBox[{
               RowBox[{"-", "1"}], "/", "2"}]]}], ")"}], "2"], 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             RowBox[{"c", "[", "n", "]"}], "-", 
             RowBox[{"c", "[", 
              RowBox[{"n", "+", "1"}], "]"}]}], ")"}], "2"]}], "+", " ", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"\[Delta]N", "[", 
            RowBox[{"y", "[", "n", "]"}], "]"}], "2"], 
          RowBox[{"JJ", "[", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"m", "-", 
              RowBox[{"2", "n"}], "-", "1", "-", "s"}], ")"}], "/", "2"}], 
           "]"}], 
          SuperscriptBox[
           FractionBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox["\[Epsilon]1", 
               RowBox[{"1", "/", "2"}]], "+", "1"}], ")"}], 
            RowBox[{
             SuperscriptBox["\[Epsilon]1", 
              RowBox[{"1", "/", "2"}]], "\[Epsilon]2"}]], "2"], 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             RowBox[{"dd", "[", "n", "]"}], "+", 
             RowBox[{"dd", "[", 
              RowBox[{"n", "+", "1"}], "]"}]}], ")"}], "2"]}], "+", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"\[Delta]N", "[", 
            RowBox[{"xx", "[", "n", "]"}], "]"}], "2"], 
          RowBox[{"KroneckerDelta", "[", 
           RowBox[{"m", ",", 
            RowBox[{
             RowBox[{"2", "n"}], "+", "1", "+", "s"}]}], "]"}], 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"1", "+", 
             SuperscriptBox["\[Epsilon]2", 
              RowBox[{
               RowBox[{"-", "1"}], "/", "2"}]]}], ")"}], "2"], 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             RowBox[{"c", "[", "n", "]"}], "-", 
             RowBox[{"c", "[", 
              RowBox[{"n", "+", "1"}], "]"}]}], ")"}], "2"]}], "+", " ", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"\[Delta]N", "[", 
            RowBox[{"yy", "[", "n", "]"}], "]"}], "2"], 
          RowBox[{"JJ", "[", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"m", "-", 
              RowBox[{"2", "n"}], "-", "1", "-", "s"}], ")"}], "/", "2"}], 
           "]"}], 
          SuperscriptBox[
           FractionBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox["\[Epsilon]1", 
               RowBox[{"1", "/", "2"}]], "-", "1"}], ")"}], 
            RowBox[{
             SuperscriptBox["\[Epsilon]1", 
              RowBox[{"1", "/", "2"}]], "\[Epsilon]2"}]], "2"], 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             RowBox[{"dd", "[", "n", "]"}], "+", 
             RowBox[{"dd", "[", 
              RowBox[{"n", "+", "1"}], "]"}]}], ")"}], "2"]}]}], " ", ")"}], 
       FractionBox[
        SuperscriptBox["np", "2"], "64"]}]}]}]}], ";"}], " "}]], "Input",
 CellChangeTimes->{{3.804205738903788*^9, 3.8042060444826975`*^9}, {
  3.8042060925513935`*^9, 3.80420621932928*^9}, {3.804206254688476*^9, 
  3.804206368261527*^9}, {3.804206406732791*^9, 3.804206659260997*^9}, {
  3.8042090476098003`*^9, 
  3.8042090483355956`*^9}},ExpressionUUID->"af7b8d18-cc17-472e-b1c1-\
e83acf990f3c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "\:0431\:043b\:043e\:043a", " ", 
    "\:0438\:043d\:0438\:0446\:0438\:0430\:043b\:0438\:0437\:0438\:0438"}], 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"JJ", "[", "n_", "]"}], ":=", " ", 
     RowBox[{
      RowBox[{"BesselJ", "[", 
       RowBox[{"n", ",", " ", 
        FractionBox[
         RowBox[{"kp", " ", "np", " ", "\[Delta]\[Epsilon]"}], 
         RowBox[{"8", "q", " ", 
          SuperscriptBox["\[Epsilon]1", 
           RowBox[{"1", "/", "2"}]]}]]}], "]"}], "/.", "long"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"x", "[", "n_", "]"}], ":=", " ", 
     RowBox[{
      RowBox[{
       SubscriptBox["k", "0"], 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"n3", " ", "\[Beta]3"}]}], ")"}]}], "/.", "long"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"xx", "[", "n_", "]"}], ":=", " ", 
     RowBox[{
      RowBox[{
       SubscriptBox["k", "0"], 
       RowBox[{"(", 
        RowBox[{"1", "+", 
         RowBox[{"n3", " ", "\[Beta]3"}]}], ")"}]}], "/.", "long"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"y", "[", "n_", "]"}], ":=", 
     RowBox[{
      RowBox[{
       SubscriptBox["k", "0"], 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"n32", " ", "\[Beta]3"}]}], ")"}]}], "/.", "long"}]}], ";"}],
    "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"yy", "[", "n_", "]"}], ":=", 
     RowBox[{
      RowBox[{
       SubscriptBox["k", "0"], 
       RowBox[{"(", 
        RowBox[{"1", "+", 
         RowBox[{"n32", " ", "\[Beta]3"}]}], ")"}]}], "/.", "long"}]}], ";"}],
    "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"d", "[", "n_", "]"}], ":=", " ", 
     RowBox[{
      RowBox[{
       SuperscriptBox["\[Epsilon]1", 
        RowBox[{
         RowBox[{"-", "1"}], "/", "4"}]], 
       SuperscriptBox["\[Epsilon]2", 
        RowBox[{
         RowBox[{"-", "1"}], "/", "2"}]], 
       RowBox[{"BesselJ", "[", 
        RowBox[{
         RowBox[{"-", "n"}], ",", " ", 
         FractionBox[
          RowBox[{"kp", " ", "np", " ", "\[Delta]\[Epsilon]"}], 
          RowBox[{"8", "q", " ", 
           SuperscriptBox["\[Epsilon]1", 
            RowBox[{"1", "/", "2"}]]}]]}], "]"}]}], "/.", "long"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"dd", "[", "n_", "]"}], ":=", " ", 
     RowBox[{
      RowBox[{
       SuperscriptBox["\[Epsilon]1", 
        RowBox[{"1", "/", "4"}]], 
       SuperscriptBox["\[Epsilon]2", 
        RowBox[{
         RowBox[{"-", "1"}], "/", "2"}]], 
       RowBox[{"BesselJ", "[", 
        RowBox[{
         RowBox[{"-", "n"}], ",", " ", 
         FractionBox[
          RowBox[{"kp", " ", "np", " ", "\[Delta]\[Epsilon]"}], 
          RowBox[{"8", "q", " ", 
           SuperscriptBox["\[Epsilon]1", 
            RowBox[{"1", "/", "2"}]]}]]}], "]"}]}], "/.", "long"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"c", "[", "n_", "]"}], ":=", " ", 
     RowBox[{
      RowBox[{
       FractionBox[
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", " ", 
            RowBox[{"Abs", "[", "n", "]"}]}], "-", "1"}], ")"}], "!!"}], 
        RowBox[{
         SuperscriptBox["\[Epsilon]2", 
          RowBox[{"1", "/", "2"}]], " ", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"Abs", "[", "n", "]"}], ")"}], "!"}]}]], 
       SuperscriptBox[
        RowBox[{"(", 
         FractionBox[
          SuperscriptBox["np", "2"], "\[Epsilon]2"], ")"}], 
        RowBox[{"Abs", "[", "n", "]"}]]}], "/.", "long"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.8042066687011805`*^9, 3.804206753858221*^9}, {
   3.804206900459695*^9, 3.80420699829186*^9}, {3.8042070467097797`*^9, 
   3.804207103503207*^9}, {3.8042071473767*^9, 3.80420719555684*^9}, {
   3.80420724258804*^9, 3.8042073336894*^9}, {3.8042074661721525`*^9, 
   3.8042075198846407`*^9}, {3.8042075725487595`*^9, 3.8042076400665665`*^9}, 
   3.80420804670267*^9, {3.80420808446478*^9, 3.8042081092904873`*^9}, {
   3.8042082539366455`*^9, 3.8042082791739216`*^9}, {3.8042083292521453`*^9, 
   3.8042083445603514`*^9}, 3.804208637618044*^9, {3.80420868914283*^9, 
   3.804208826282998*^9}, {3.8042088592252*^9, 3.8042089783298445`*^9}},
 CellLabel->
  "In[138]:=",ExpressionUUID->"0a365b5d-0236-479c-9351-e7f13178b1cd"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.8042080429793386`*^9, 
  3.804208043035639*^9}},ExpressionUUID->"56dd91bc-d8ee-4bbe-ad06-\
36d37abea59b"]
},
WindowSize->{1277, 998},
WindowMargins->{{Automatic, -7}, {Automatic, 0}},
FrontEndVersion->"12.0 for Microsoft Windows (64-bit) (April 8, 2019)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 2595, 66, 201, "Input",ExpressionUUID->"b033db3c-807e-4aff-9071-e56f7d649752"],
Cell[3156, 88, 13230, 357, 718, "Input",ExpressionUUID->"eeab84a9-99c5-469a-8133-2ca4c9c06858"],
Cell[16389, 447, 152, 3, 28, "Input",ExpressionUUID->"b8ebbb03-2a5d-4f9d-91ab-fabf70387318"],
Cell[16544, 452, 4471, 121, 195, "Input",ExpressionUUID->"af7b8d18-cc17-472e-b1c1-e83acf990f3c"],
Cell[21018, 575, 4572, 133, 392, "Input",ExpressionUUID->"0a365b5d-0236-479c-9351-e7f13178b1cd"],
Cell[25593, 710, 154, 3, 28, InheritFromParent,ExpressionUUID->"56dd91bc-d8ee-4bbe-ad06-36d37abea59b"]
}
]
*)

